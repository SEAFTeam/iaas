entities:
  seaf.ta.reverse.cloud_ru.advanced.eips:
    presentations:
      table_view:
        type: table
        headers:
          - value: ext_address
            text: Внешний адрес
            width: 20%
            sortable: true
          - value: int_address
            text: Внутренний адрес
            width: 20%
            sortable: true
          - value: throughput
            text: Пропускная способность (Мб/с)
            width: 20%
            sortable: true
          - value: rule_name
            text: Имя правила
            width: 20%
            sortable: true
          - value: type
            text: Производительность
            width: 20%
            sortable: true
          - value: port_id
            text: Идентификатор порта для которого привязан IP
            width: 20%
            sortable: true
          - value: tenant
            text: Тенант
            width: 20%
            sortable: true
#          - value: id
#            text: Идентификатор объекта
#            width: 20%
#            sortable: true
        source: >
          (    
              $ctx := $params;
              $domain_matcher := $eval('/^' & $ctx.domain & '.*/');
              $eips := $."seaf.ta.reverse.cloud_ru.advanced.eips" ~> $each(function($v, $k){$domain_matcher($k) ? {$k:$v}});
              [$eips.(
                  {
                    "id": $keys()[0],
                    "eip": $.*
                  }
              ).eip ~> | $ | {'rule_name': limit.rule_name, 'throughput': limit.throughput } |]
          )
      eip_md:
        type: markdown
        template: templates/eip.md
        source: >
          (
              $ctx := $params;
              $domain_matcher := $eval('/^' & $ctx.domain & '.*/');
              $eips := $."seaf.ta.reverse.cloud_ru.advanced.eips" ~> $each(function($v, $k){$domain_matcher($k) ? {$k:$v}});
              [$eips.(
                  {
                    "id": $keys()[0],
                    "eip": $.*
                  }
              ).eip ~> | $ | {'rule_name': limit.rule_name, 'throughput': limit.throughput } |]
          )